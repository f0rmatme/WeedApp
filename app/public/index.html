<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Blog Post - Start Bootstrap Template</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/submit.css" rel="stylesheet">


  </head>

  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand" href="index.html">TokeTalk</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#">Feed
                <span class="sr-only">(current)</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Profile</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Settings</a>
            </li>
            </li>
          </ul>
        </div>
        <div>
            <form class="navbar-form" role="search">
              <div class="input-group">
                <input type="text" class="form-control" placeholder="Search for...">
                <span class="input-group-btn">
                  <button class="btn btn-secondary" type="button">Go!</button>
                </span>
              </div>
            </form>
          </div>
      </div>
    </nav>
</br>

    <!-- Page Content -->
    <div class="container">

      <div class="row">

        <!-- Post Content Column -->
        <div class="col-lg-8" id="post" style="padding-top: 20px;">

          <script>
            var bodyText = "";
            document.addEventListener('DOMContentLoaded', function () {
              const renderPost = (body, post) => {
                const section = document.createElement('section');
                var domString = `
                <!-- Title -->
                <h4 class="mt-4" style="padding-top: 10px">
                  <img class="img-fluid rounded-circle" src=${post.user.profilepic} alt="" style="width:64px;height:64px;">
                  ${post.user.username}
                </h4>

                <hr>

                <div class="row">
                  <div class="col-sm-4">
                      <img class="img-fluid rounded" src="${post.weed.pictureUrl}" alt="" style="padding: 5px;">
                  </div>
                  <div class="col-sm-8" style="padding-top: 10px;">
                    <!--<div class="col">Name: ${post.name}</div>-->
                    <div class="col">Weed: ${post.weed.name}</div>
                    <div class="col">Strain: ${post.weed.strain}</div>
                    <div class="col">THC: ${post.weed.thc}%</div>
                    <div class="col">CBD: ${post.weed.cbd}</div>
                    <div class="col">Company: ${post.weed.company}</div>
                  </div>
                </div>
              
                <div class="row">
                  <div class="col">Tags:</div>
                  <div class="col">PostID:</div>
                  <div class="col">Date:</div>
                  
                </div>

                <hr>

                <!-- Post Content -->
                <div> 
                  ${post.content}
                </div>

                <hr>
                `;
                //document.getElementById("post").innerHTML += domString;
                //$(".col-lg-8").append( domString );
                $('#post').append(domString);
                body.appendChild(section);
              };
              const fetchAndRender = async () => {
                const promisePosts = await fetch("/posts");
                const posts = await promisePosts.json();
                console.log(posts);
                const body = document.body;
                posts.map((post, index) => {
                  if (posts[index]) {
                    renderPost(body, post);
                  }
                });
              };
              fetchAndRender();
            });
          </script>

          

        </div>


        <!-- Sidebar Widgets Column -->
        <div class="col-md-4" style="padding-top: 20px">

          <!-- Submit Post Widget -->
          <div id="submit" class="btn-block" role="group" aria-label="Basic example">
            <button class="btn btn-secondary" id="sub-btn" onclick="loadPage()">Submit Post</button> 
          </div>

          <script>
              function loadPage()
              {
                   location.href = "submit_post.html";
              } 
          </script>

          <!-- Side Widget -->
          <div class="card my-4">
            <h4 class="card-header">
              <img class="img-fluid rounded-circle" src="https://avatars0.githubusercontent.com/u/23488590?s=460&v=4/" style="width:64px;height:64px;" alt="">
              Eric
            </h4>

            <div class="container">
                <div class="row">
                  <div class="col-5">Username:</div>
                  <div class="col-5">eric_is_the_best</div>
                </div>
                <div class="row">
                    <div class="col-5">Email:</div>
                    <div class="col-5">eric@eric.com</div>
                </div>
                <div class="row">
                    <div class="col-5">Bio:</div>
                    <div class="col-5">Programming!</div>
                </div>
                <div class="row">
                    <div class="col-5">Join Date:</div>
                    <div class="col-5">Dec 1, 2018</div>
                </div>
            </div>

            <!-- <div class="card-body">
              <div class="row">Username: eric_is_the_best</div>
              <div class="row">Email: eric@eric.com</div>
              <div class="row">Bio: I love to program</div>
              <div class="row">Join Date: December 1, 2018</div>
            </div> -->
          </div>

          <!-- Categories Widget -->
          <div class="card my-4">
            <h5 class="card-header">Categories</h5>
            <div class="card-body">
              <div class="row">
                <div class="col-lg">
                  <ul class="list-unstyled mb-0">
                    <li>
                      <a href="category.html">Weed</a>
                    </li>
                  </ul>
                </div>
                <div class="col-lg">
                  <ul class="list-unstyled mb-0">
                    <li>
                      <a href="#">Company</a>
                    </li>
                  </ul>
                </div>
                <div class="col-lg">
                    <ul class="list-unstyled mb-0">
                      <li>
                        <a href="#">Tags</a>
                      </li>
                    </ul>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- /.row -->

    </div>
    <!-- /.container -->

    <!-- Footer -->
    <footer class="py-5 bg-dark">
      <div class="container">
        <p class="m-0 text-center text-white">Copyright &copy; TokeTalk 2018</p>
      </div>
      <!-- /.container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="/vendor/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  </body>

</html>
